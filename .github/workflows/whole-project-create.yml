name: "C1 - Whole project: Create"
run-name: "C1 - Whole project: Create"

on: 
  workflow_dispatch:
    inputs:
      CONFIRMATION:
        required: true
        type: string
        description: "Vazio aborta. Qualquer valor confirma."

jobs:
  ################################# 
  ######## Create project #########
  #################################
  github_sync:
    uses: ./.github/workflows/single-sub-project-run.yml
    with:
      RESOURCE: '1a'
    secrets: inherit

  vpc_app:
    needs: [
      github_sync
    ]
    uses: ./.github/workflows/single-sub-project-run.yml
    with:
      RESOURCE: '2a'
    secrets: inherit

  acm_ssl:
    needs: [
      github_sync
    ]
    uses: ./.github/workflows/single-sub-project-run.yml
    with:
      RESOURCE: '2c'
    secrets: inherit

  rds_mysql:
    needs: [
      github_sync, 
      vpc_app
    ]
    uses: ./.github/workflows/single-sub-project-run.yml
    with:
      RESOURCE: '3b'
    secrets: inherit

  # efs_static_files:
  #   needs: [
  #     github_sync, 
  #     vpc_app
  #   ]
  #   uses: ./.github/workflows/single-sub-project-run.yml
  #   with:
  #     RESOURCE: '3c'
  #   secrets: inherit

  app_ami:
    needs: [
      github_sync,
      vpc_app,
      rds_mysql
    ]
    uses: ./.github/workflows/single-sub-project-run.yml
    with:
      RESOURCE: '4c'
    secrets: inherit

  elb_app:
    needs: [
      github_sync,
      vpc_app,
      rds_mysql,
      app_ami
    ]
    uses: ./.github/workflows/single-sub-project-run.yml
    with:
      RESOURCE: '6a'
    secrets: inherit